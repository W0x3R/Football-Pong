"use strict";function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,l=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw l}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var field=document.querySelector(".field"),ballImg=document.querySelector(".field__ball"),fieldImg=document.querySelector(".field__img"),playerOneScore=document.querySelector(".player-one-score"),playerTwoScore=document.querySelector(".player-two-score"),restartButton=document.querySelector(".field__restart-btn"),fullscreen=document.querySelector(".fullscreen-toggle"),portraitOrientationTitle=document.createElement("h1");portraitOrientationTitle.textContent="Please use landscape orientation and click on the icon to enable full screen mode for the game to work correctly!",portraitOrientationTitle.classList.add("portrait-orientation__message");var flag=0,getSessionScore=function(e,t){return e.textContent=sessionStorage.getItem(t)},setSessionScore=function(e,t){return sessionStorage.setItem(e,t)},checkSessionScorePresence=function(){sessionStorage.getItem("playerOneScore")&&sessionStorage.getItem("playerTwoScore")?(getSessionScore(playerOneScore,"playerOneScore"),getSessionScore(playerTwoScore,"playerTwoScore")):(playerOneScore.textContent=0,playerTwoScore.textContent=0)};restartButton.addEventListener("click",(function(){setSessionScore("playerOneScore",0),setSessionScore("playerTwoScore",0),getSessionScore(playerOneScore,"playerOneScore"),getSessionScore(playerTwoScore,"playerTwoScore")}));var getCurrentBallWidth=function(){return ballImg.width},getCurrentFieldWidth=function(){return fieldImg.width},getCurrentFieldHeight=function(){return fieldImg.height},getCurrentPaddingOfField=function(e){return parseInt(getComputedStyle(fieldImg).padding+e)},getCurrentCenterOfField=function(){return parseInt(getCurrentFieldHeight()/2)-getCurrentBallWidth()/2+getCurrentPaddingOfField("Top")},delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))},positionLeft=function(){ballImg.style.left=25+getCurrentPaddingOfField("Left")+"px",ballImg.style.top=25+getCurrentPaddingOfField("Top")+"px",delay(50).then((function(){return ballImg.style.transition="none"})),delay(300).then((function(){return ballImg.style.transition="all 0.6s ease-in"}))},positionRight=function(){ballImg.style.left=getCurrentFieldWidth()-getCurrentBallWidth()+getCurrentPaddingOfField("Left")-25+"px",ballImg.style.top=25+getCurrentPaddingOfField("Top")+"px",delay(50).then((function(){return ballImg.style.transition="none"})),delay(300).then((function(){return ballImg.style.transition="all 0.6s ease-in"}))},checkFlagResize=function(){"0"===sessionStorage.getItem("flag")?positionLeft():positionRight()};function changeStylesPortraitOrientation(){field.classList.add("portrait-orientation"),field.append(portraitOrientationTitle);var e,t=_createForOfIteratorHelper(field.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("H1"===n.tagName)break;n.style.display="none"}}catch(e){t.e(e)}finally{t.f()}checkFlagResize()}function changeStylesLandscapeOrientation(){field.classList.remove("portrait-orientation"),portraitOrientationTitle.remove();var e,t=_createForOfIteratorHelper(field.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;"players-score"===n.className?n.style.display="flex":n.style.display="block"}}catch(e){t.e(e)}finally{t.f()}checkFlagResize()}var checkOrientation=function(){window.matchMedia("(orientation: portrait)").matches&&changeStylesPortraitOrientation(),window.matchMedia("(orientation: landscape)").matches&&changeStylesLandscapeOrientation()};function toggleScreen(){var e=window.document,t=e.documentElement,n=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen,r=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?r.call(e):n.call(t)}function mathRandom(){var e=25+Math.ceil(getCurrentPaddingOfField("Top")),t=Math.floor(getCurrentFieldHeight()-getCurrentBallWidth()+getCurrentPaddingOfField("Bottom")-25);return Math.floor(Math.random()*(t-e+1)+e)}function playKickSound(){new Audio("kick.mp3").play()}function playGoalSound(){new Audio("goal.mp3").play()}function playHitTheNet(){new Audio("hit-the-net.mp3").play()}window.addEventListener("resize",(function(){checkFlagResize(),checkOrientation(),checkSessionScorePresence()})),window.addEventListener("load",(function(){checkOrientation(),checkFlagResize(),checkSessionScorePresence()})),fullscreen.addEventListener("click",toggleScreen);var checkWidthOfGoal=function(){var e=getCurrentCenterOfField();console.log(e);for(var t=0,n=[{min:570,height:183},{min:540,height:172},{min:520,height:164},{min:500,height:157},{min:470,height:145},{min:446,height:137},{min:420,height:127},{min:388,height:116},{min:360,height:108},{min:332,height:100},{min:300,height:88},{min:282,height:78},{min:261.5,height:76},{min:246.5,height:73},{min:223.5,height:68},{min:208.5,height:62}];t<n.length;t++){var r=n[t];if(e>=r.min)return r.height}if(e<208.5)return 18};function showGoal(e){delay(700).then((function(){return e.style.color="red"})),delay(1600).then((function(){return e.style.color="#e4ff00"}))}function checkFirstPlayerScore(){parseInt(ballImg.style.top)<=getCurrentCenterOfField()+checkWidthOfGoal()&&parseInt(ballImg.style.top)>=getCurrentCenterOfField()-checkWidthOfGoal()&&(delay(200).then(playHitTheNet),setSessionScore("flag",flag=1),delay(700).then((function(){playGoalSound(),playerOneScore.textContent++,setSessionScore("playerOneScore",playerOneScore.textContent),ballImg.style.left=getCurrentFieldWidth()-25,ballImg.style.top=25+getCurrentPaddingOfField("Top")+"px"})),showGoal(playerOneScore))}function checkSecondPlayerScore(){parseInt(ballImg.style.top)<=getCurrentCenterOfField()+checkWidthOfGoal()&&parseInt(ballImg.style.top)>=getCurrentCenterOfField()-checkWidthOfGoal()&&(delay(200).then(playHitTheNet),delay(700).then((function(){playGoalSound(),playerTwoScore.textContent++,setSessionScore("playerTwoScore",playerTwoScore.textContent),ballImg.style.left=25+getCurrentPaddingOfField("Left")+"px",ballImg.style.top=25+getCurrentPaddingOfField("Top")+"px"})),showGoal(playerTwoScore))}ballImg.addEventListener("click",(function(){playKickSound(),"0"===sessionStorage.getItem("flag")?(ballImg.style.left=getCurrentFieldWidth()-getCurrentBallWidth()+ +getCurrentPaddingOfField("Right")-25+"px",ballImg.style.top=mathRandom()+"px",checkFirstPlayerScore(),flag++,setSessionScore("flag",flag)):(ballImg.style.left=+getCurrentPaddingOfField("Left")+25+"px",ballImg.style.top=mathRandom()+"px",checkSecondPlayerScore(),setSessionScore("flag",flag=0))}));